# UZoneのアカウントに対してメール送信プログラム

## メール送信
1. デスクトップ上にある フォルダ`UZone_CRMメール送信` にアクセス
2. フォルダ内にある `UZone_CRM_データセット.bat` をダブルクリック
ファルダ内の`TRAN_DATA`配下に当日付のフォルダが作成されます
3. 作成された当日付のフォルダにアクセス
フォルダの場所 `TRAN_DATA/{year_month_date}`
フォルダ内には宛先リスト`mail_status.csv`、紹介するパーツ名を設定する`parts_name.txt`が作成されます

### ユーザ設定部分
4. 当日付のフォルダ配下に今回送信したい情報をセットしていく
5. 紹介するパーツ名を`parts_name.txt`内に記述する
6. 添付したい画像をファイル名`mail`で、ファイル形式を`png`にする

### メール自動送信部分
7. `UZone_CRM`配下に移動
8. `メール自動送信.bat`をダブルクリック
9. 1通目はOutlookのアプリでプレビュー表示されるので、それを確認して問題がなければ送信をクリック
10. そのまま送信を続ける場合は、黒い画面で`y`を打ち込み、`Enter`を押してください


## 注意点
- bat処理 `UZone_CRM_データセット.bat`と`メール自動送信.bat`の2つは同一日に実行するようにしてください。
実行できなかった場合は、最初からやりなおすようにしてください。

- メールのフォーマットなどを、変更したい場合は、*藤原*に連絡してください。
すぐしたければ、件名は`UZone_CRMメール送信/MASTER_DATA/subject.txt`、メール本文は`UZone_CRMメール送信/MASTER_DATA/mail.html`を変更すればいけます。

- メール送信先の取得は、絶対PATH的に指定してしまっているので、変えたい場合は、`PROGRAM/get_target_data.py`内のソースコードを変更するようにしてください。
